---
title: "Data Analysis Exercise"
---

```{r}

# load dslabs package
library("dslabs") 
library("dplyr")
library("ggplot2")

# get an overview of data structure
str(gapminder)

# get a summary of data
summary(gapminder)

# determine the type of object gapminder is
class(gapminder)

africadata <- gapminder %>%
  filter(continent == "Africa")

# Create a new data frame with only 'infant_mortality' and 'life_expectancy'
africa_mort_life <- africadata %>%
  select(infant_mortality, life_expectancy)

# Create another data frame with only 'population' and 'life_expectancy'
africa_pop_life <- africadata %>%
  select(population, life_expectancy)

# Check the structure of the first new object
str(africa_mort_life)
# Check a summary of the data to understand distributions and NA presence
summary(africa_mort_life)

# Check the structure of the second new object
str(africa_pop_life)
# Summary of population and life expectancy
summary(africa_pop_life)
```

I created two new data frames from the "africadata" object:  
- "africa_mort_life": Contains only the "infant_mortality" and "life_expectancy" columns.
- "africa_pop_life": Contains only the "population" and "life_expectancy" columns.

Both data frames contain 2907 rows (one for each African country-year observation) and 2 columns. I used str() to inspect the structure (data types and column names) and summary() to examine the distribution and detect missing values.

```{r}
# Load dplyr package
library(dplyr)

# Create the object with infant_mortality and life_expectancy
africa_mort_life <- africadata %>%
  select(infant_mortality, life_expectancy)

# Plotting  Life expectancy vs infant mortality 
ggplot(africa_mort_life, aes(x = infant_mortality, y = life_expectancy)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  labs(
    title = "Life expectancy vs Infant mortality in Africa",
    x = "Infant Mortality",
    y = "Life Expectancy (years)"
  ) +
  theme_minimal()

```

This plot shows a  negative correlation between infant mortality and life expectancy. Countries with higher infant mortality tend to have lower life expectancy. 

```{r}
# Create population vs life expectancy data from africadata
africa_pop_life <- africadata %>%
  select(population, life_expectancy)

# Plotting Life expectancy vs pop size 
ggplot(africa_pop_life, aes(x = population, y = life_expectancy)) +
  geom_point(alpha = 0.6, color = "darkgreen") +
  scale_x_log10() +  # log scale for population
  labs(
    title = "Life expectancy vs Population size",
    x = "Population (log scale)",
    y = "Life Expectancy (years)"
  ) +
  theme_minimal()

```

Here, we observe a positive correlation between population size and life expectancy.

However, the data displays streaks of points. When we examine the original africadata again, we notice that each country has multiple entries over time (from 1960 to 2016). These streaks represent temporal data points for each country, where each streak corresponds to a single country progressing over time.

```{r}
# Now perform analysis for year 20000
africadata_year2000 <- subset(africadata, year == 2000)
# get an overview of data structure
str(africadata_year2000)

 # summary of data
summary(africadata_year2000)

ggplot(africadata_year2000, aes(x = infant_mortality, y = life_expectancy)) +
  geom_point(color = "steelblue", alpha = 0.7) +
  labs(
    title = "Life Expectancy vs Infant Mortality -year 2000",
    x = "Infant mortality",
    y = "Life expectancy (years)"
  ) +
  theme_minimal()

```

```{r}

# Now we will apply models to our analysis of year 2000 to see if they are significant correlations:

# Model 1: Predict life expectancy using infant mortality
fit1 <- lm(life_expectancy ~ infant_mortality, data = africadata_year2000)

# Model 2: Predict life expectancy using population size
fit2 <- lm(life_expectancy ~ population, data = africadata_year2000)

# Print model summaries to screen
summary(fit1)

lm(formula = life_expectancy ~ infant_mortality, data = africadata_year2000)

summary(fit2)

lm(formula = life_expectancy ~ population, data = africadata_year2000)

```

I fitted two simple linear regression models using the lm() function on African countries in the year 2000:

Model 1 (fit1): Life expectancy as a function of infant mortality.
- The model shows a negative correlation between infant mortality and life expectancy.
- The estimate for infant mortality is negative and statistically significant (very low p-value), which confirms this inverse relationship.

Model 2 (fit2): Life expectancy as a function of population size.
- This model shows not a strong correlation between population size and life expectancy.
- The p-value and r-quared are not significant.

In the year 2000, infant mortality is a stronger predictor of life expectancy than population size, at least in the year 2000 in Africa. 